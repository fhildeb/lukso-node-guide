"use strict";(globalThis.webpackChunklukso_node_guide=globalThis.webpackChunklukso_node_guide||[]).push([[2546],{1968(e,n,t){t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>c,default:()=>p,frontMatter:()=>l,metadata:()=>r,toc:()=>u});const r=JSON.parse('{"id":"guides/maintenance/reset-blockchain-state","title":"11.7 Reset Blockchain State","description":"Learn how to reset your LUKSO node\'s blockchain state to resolve sync errors, client crashes, and data corruption when switching or updating execution clients.","source":"@site/docs/guides/maintenance/reset-blockchain-state.md","sourceDirName":"guides/maintenance","slug":"/guides/maintenance/reset-blockchain-state","permalink":"/docs/guides/maintenance/reset-blockchain-state","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":7,"frontMatter":{"sidebar_label":"11.7 Reset Blockchain State","sidebar_position":7,"description":"Learn how to reset your LUKSO node\'s blockchain state to resolve sync errors, client crashes, and data corruption when switching or updating execution clients."},"sidebar":"guidesSidebar","previous":{"title":"11.6 Gas Price Configuration","permalink":"/docs/guides/maintenance/gas-price-configuration"},"next":{"title":"11.8 Monitoring Settings","permalink":"/docs/guides/maintenance/monitoring-settings"}}');var s=t(4848),a=t(8453),i=t(1470),o=t(9365);const l={sidebar_label:"11.7 Reset Blockchain State",sidebar_position:7,description:"Learn how to reset your LUKSO node's blockchain state to resolve sync errors, client crashes, and data corruption when switching or updating execution clients."},c="11.7 Reset Blockchain State",d={},u=[{value:"1. Stop Node Operation",id:"1-stop-node-operation",level:2},{value:"2. Remove Blockchain Data",id:"2-remove-blockchain-data",level:2},{value:"3. Restart the Node",id:"3-restart-the-node",level:2}];function h(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components},{Details:t}=n;return t||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"117-reset-blockchain-state",children:"11.7 Reset Blockchain State"})}),"\n",(0,s.jsx)(n.p,{children:"When updating or switching execution clients, incompatibilities may arise with the existing blockchain state. These errors often occur due to changes in the client\u2019s internal database structure, chain data corruption, or leftover logs. Resetting the blockchain state can resolve sync issues, failed starts, and client crashes by reinitializing a clean local environment."}),"\n",(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsxs)(n.p,{children:["The following steps are performed on your \ud83d\udcdf ",(0,s.jsx)(n.strong,{children:"node server"}),"."]})}),"\n",(0,s.jsx)(n.h2,{id:"1-stop-node-operation",children:"1. Stop Node Operation"}),"\n",(0,s.jsx)(n.p,{children:"Depending on your setup method, there are different ways to stop your node before applying updates."}),"\n",(0,s.jsxs)(i.A,{groupId:"setup",children:[(0,s.jsxs)(o.A,{value:"cli",label:"LUKSO CLI",default:!0,children:[(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"cd <lukso-working-directory>\nlukso stop\n"})}),(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsxs)(n.p,{children:["Exchange ",(0,s.jsx)(n.code,{children:"<lukso-working-directory>"})," with the path of the node folder."]})})]}),(0,s.jsx)(o.A,{value:"automation",label:"Service Automation",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"sudo systemctl stop lukso-validator\n"})})})]}),"\n",(0,s.jsxs)(t,{children:[(0,s.jsx)("summary",{children:"Force Client Shutdown"}),(0,s.jsxs)(i.A,{children:[(0,s.jsx)(o.A,{value:"geth",label:"Geth",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"sudo pkill geth\n"})})}),(0,s.jsx)(o.A,{value:"erigon",label:"Erigon",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"sudo pkill erigon\n"})})}),(0,s.jsx)(o.A,{value:"nethermind",label:"Nethermind",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"sudo pkill nethermind\n"})})}),(0,s.jsx)(o.A,{value:"besu",label:"Besu",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"sudo pkill besu\n"})})}),(0,s.jsx)(o.A,{value:"teku",label:"Teku",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"sudo pkill teku\n"})})}),(0,s.jsx)(o.A,{value:"nimbus2",label:"Nimbus-Eth2",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"sudo pkill nimbus_beacon_node\nsudo pkill nimbus_validator_client\n"})})}),(0,s.jsxs)(o.A,{value:"lighthouse",label:"Lighthouse",children:[(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"sudo pkill lighthouse\n"})}),(0,s.jsx)(n.admonition,{type:"tip",children:(0,s.jsx)(n.p,{children:"The Lighthouse client uses a single binary for both the consensus and validator processes."})})]}),(0,s.jsx)(o.A,{value:"prysm",label:"Prysm",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"sudo pkill prysm\nsudo pkill validator\n"})})})]})]}),"\n",(0,s.jsx)(n.h2,{id:"2-remove-blockchain-data",children:"2. Remove Blockchain Data"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"# Move into Node Directory\ncd <lukso-working-directory>\n\n# Remove Blockchain Data\nrm -rf <network>-data\n\n# Remove Logs\nrm -rf <network>-logs\n\n# Initialize the Folder\nsudo lukso init\n"})}),"\n",(0,s.jsx)(n.admonition,{type:"tip",children:(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"lukso init"})," command only adds missing files within the ",(0,s.jsx)(n.code,{children:"/configs/"})," folder without overwriting existing ones."]})}),"\n",(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsxs)(n.p,{children:["Exchange ",(0,s.jsx)(n.code,{children:"<lukso-working-directory>"})," and ",(0,s.jsx)(n.code,{children:"<network>"})," with the path of the node folder and the configured network."]})}),"\n",(0,s.jsx)(n.h2,{id:"3-restart-the-node",children:"3. Restart the Node"}),"\n",(0,s.jsx)(n.p,{children:"Depending on your setup method, there are different ways to start your node after the blockchain state was cleared."}),"\n",(0,s.jsxs)(i.A,{groupId:"setup",children:[(0,s.jsxs)(o.A,{value:"clinode",label:"LUKSO CLI Node",default:!0,children:[(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"cd <lukso-working-directory>\nlukso start --checkpoint-sync\n"})}),(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsxs)(n.p,{children:["Exchange ",(0,s.jsx)(n.code,{children:"<lukso-working-directory>"})," with the path of the node folder."]})})]}),(0,s.jsxs)(o.A,{value:"clivalidator",label:"LUKSO CLI Validator",default:!0,children:[(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:'cd <lukso-working-directory>\nlukso start --validator --transaction-fee-recipient "<your-fee-recipient-address>" --checkpoint-sync\n'})}),(0,s.jsxs)(n.admonition,{type:"info",children:[(0,s.jsx)(n.p,{children:"The following properties need to be exchanged:"}),(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"<lukso-working-directory>"})," with the path of the node folder"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"<your-fee-recipient-address>"})," with the wallet address receiving staking profits"]}),"\n"]})]})]}),(0,s.jsx)(o.A,{value:"automation",label:"Service Automation",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"sudo systemctl start lukso-validator\n"})})})]}),"\n",(0,s.jsx)(n.p,{children:"After the clients were started, verify that their services are still up."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"sudo lukso status\n"})}),"\n",(0,s.jsx)(n.admonition,{type:"warning",children:(0,s.jsxs)(n.p,{children:["If you are still running into issues, ",(0,s.jsx)(n.a,{href:"/docs/guides/maintenance/problem-scanning",children:"scan for problems"}),", ",(0,s.jsx)(n.a,{href:"/docs/guides/maintenance/client-updates",children:"update your clients and configuration"}),", or ",(0,s.jsx)(n.a,{href:"/docs/guides/maintenance/revert-client-versions",children:"revert the client version"}),"."]})})]})}function p(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}},9365(e,n,t){t.d(n,{A:()=>i});t(6540);var r=t(4164);const s="tabItem_Ymn6";var a=t(4848);function i({children:e,hidden:n,className:t}){return(0,a.jsx)("div",{role:"tabpanel",className:(0,r.A)(s,t),hidden:n,children:e})}},1470(e,n,t){t.d(n,{A:()=>N});var r=t(6540),s=t(4164),a=t(7559),i=t(3104),o=t(6347),l=t(205),c=t(7485),d=t(1682),u=t(679);function h(e){return r.Children.toArray(e).filter(e=>"\n"!==e).map(e=>{if(!e||(0,r.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})?.filter(Boolean)??[]}function p(e){const{values:n,children:t}=e;return(0,r.useMemo)(()=>{const e=n??function(e){return h(e).map(({props:{value:e,label:n,attributes:t,default:r}})=>({value:e,label:n,attributes:t,default:r}))}(t);return function(e){const n=(0,d.XI)(e,(e,n)=>e.value===n.value);if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map(e=>e.value).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e},[n,t])}function g({value:e,tabValues:n}){return n.some(n=>n.value===e)}function m({queryString:e=!1,groupId:n}){const t=(0,o.W6)(),s=function({queryString:e=!1,groupId:n}){if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:e,groupId:n});return[(0,c.aZ)(s),(0,r.useCallback)(e=>{if(!s)return;const n=new URLSearchParams(t.location.search);n.set(s,e),t.replace({...t.location,search:n.toString()})},[s,t])]}function f(e){const{defaultValue:n,queryString:t=!1,groupId:s}=e,a=p(e),[i,o]=(0,r.useState)(()=>function({defaultValue:e,tabValues:n}){if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!g({value:e,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${n.map(e=>e.value).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}const t=n.find(e=>e.default)??n[0];if(!t)throw new Error("Unexpected error: 0 tabValues");return t.value}({defaultValue:n,tabValues:a})),[c,d]=m({queryString:t,groupId:s}),[h,f]=function({groupId:e}){const n=function(e){return e?`docusaurus.tab.${e}`:null}(e),[t,s]=(0,u.Dv)(n);return[t,(0,r.useCallback)(e=>{n&&s.set(e)},[n,s])]}({groupId:s}),x=(()=>{const e=c??h;return g({value:e,tabValues:a})?e:null})();(0,l.A)(()=>{x&&o(x)},[x]);return{selectedValue:i,selectValue:(0,r.useCallback)(e=>{if(!g({value:e,tabValues:a}))throw new Error(`Can't select invalid tab value=${e}`);o(e),d(e),f(e)},[d,f,a]),tabValues:a}}var x=t(2303);const b="tabList__CuJ",j="tabItem_LNqP";var v=t(4848);function k({className:e,block:n,selectedValue:t,selectValue:r,tabValues:a}){const o=[],{blockElementScrollPositionUntilNextRender:l}=(0,i.a_)(),c=e=>{const n=e.currentTarget,s=o.indexOf(n),i=a[s].value;i!==t&&(l(n),r(i))},d=e=>{let n=null;switch(e.key){case"Enter":c(e);break;case"ArrowRight":{const t=o.indexOf(e.currentTarget)+1;n=o[t]??o[0];break}case"ArrowLeft":{const t=o.indexOf(e.currentTarget)-1;n=o[t]??o[o.length-1];break}}n?.focus()};return(0,v.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,s.A)("tabs",{"tabs--block":n},e),children:a.map(({value:e,label:n,attributes:r})=>(0,v.jsx)("li",{role:"tab",tabIndex:t===e?0:-1,"aria-selected":t===e,ref:e=>{o.push(e)},onKeyDown:d,onClick:c,...r,className:(0,s.A)("tabs__item",j,r?.className,{"tabs__item--active":t===e}),children:n??e},e))})}function y({lazy:e,children:n,selectedValue:t}){const a=(Array.isArray(n)?n:[n]).filter(Boolean);if(e){const e=a.find(e=>e.props.value===t);return e?(0,r.cloneElement)(e,{className:(0,s.A)("margin-top--md",e.props.className)}):null}return(0,v.jsx)("div",{className:"margin-top--md",children:a.map((e,n)=>(0,r.cloneElement)(e,{key:n,hidden:e.props.value!==t}))})}function w(e){const n=f(e);return(0,v.jsxs)("div",{className:(0,s.A)(a.G.tabs.container,"tabs-container",b),children:[(0,v.jsx)(k,{...n,...e}),(0,v.jsx)(y,{...n,...e})]})}function N(e){const n=(0,x.A)();return(0,v.jsx)(w,{...e,children:h(e.children)},String(n))}},8453(e,n,t){t.d(n,{R:()=>i,x:()=>o});var r=t(6540);const s={},a=r.createContext(s);function i(e){const n=r.useContext(a);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),r.createElement(a.Provider,{value:n},e.children)}}}]);