"use strict";(globalThis.webpackChunklukso_node_guide=globalThis.webpackChunklukso_node_guide||[]).push([[8648],{8913(e,n,t){t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>c,default:()=>g,frontMatter:()=>l,metadata:()=>a,toc:()=>u});const a=JSON.parse('{"id":"guides/alert-systems/custom-messages","title":"9.4 Custom Messages","description":"Learn how to create clean and actionable alert messages in Grafana using annotations and contact point templates.","source":"@site/docs/guides/alert-systems/custom-messages.md","sourceDirName":"guides/alert-systems","slug":"/guides/alert-systems/custom-messages","permalink":"/docs/guides/alert-systems/custom-messages","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_label":"9.4 Custom Messages","sidebar_position":4,"description":"Learn how to create clean and actionable alert messages in Grafana using annotations and contact point templates."},"sidebar":"guidesSidebar","previous":{"title":"9.3 Image Rendering","permalink":"/docs/guides/alert-systems/image-rendering"},"next":{"title":"9.5 Selfnodes Alerts","permalink":"/docs/guides/alert-systems/selfnode-alerts"}}');var s=t(4848),r=t(8453),o=t(1470),i=t(9365);const l={sidebar_label:"9.4 Custom Messages",sidebar_position:4,description:"Learn how to create clean and actionable alert messages in Grafana using annotations and contact point templates."},c="9.4 Custom Messages",d={},u=[{value:"Add Message Annotations",id:"add-message-annotations",level:2},{value:"Edit Contact Point Message",id:"edit-contact-point-message",level:2}];function h(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"94-custom-messages",children:"9.4 Custom Messages"})}),"\n",(0,s.jsx)(n.p,{children:"Grafana's default alert messages often include excessive technical details and raw values that make it difficult to quickly assess the situation or determine next steps. This guide walks you through how to customize and simplify those messages using annotations and templates, helping you to get actionable alerts across any Grafana version."}),"\n",(0,s.jsxs)(o.A,{groupId:"message",children:[(0,s.jsx)(i.A,{value:"firing",label:"Default Firing Message",default:!0,children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-text",children:"**Firing**\n\nValue: B=45.07955651176187, C=1\nLabels:\n - alertname = Participation Rate below 80%\n - grafana_folder = node-alerts\n - instance = 127.0.0.1:8080\n - job = consensus-client-job\nAnnotations:\nSource: http://localhost:3000/alerting/grafana/e10d1256-082f-4ca3-a936-aceea7759d78/view?orgId=1\nSilence: http://localhost:3000/alerting/silence/new?alertmanager=grafana&matcher=alertname%3DParticipation+Rate+below+80%25&matcher=grafana_folder%3Dnode-alerts&matcher=instance%3D127.0.0.1%3A8080&matcher=job%3Dconsensus-client-job\nDashboard: http://localhost:3000/d/dashboard-id?orgId=1\nPanel: http://localhost:3000/d/dashboard-id?orgId=1&viewPanel=120\n"})})}),(0,s.jsx)(i.A,{value:"resolved",label:"Default Resolved Message",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-text",children:"**Resolved**\n\nValue: B=85.07955651176187, C=1\nLabels:\n - alertname = Participation Rate below 80%\n - grafana_folder = node-alerts\n - instance = 127.0.0.1:8080\n - job = consensus-client-job\nAnnotations:\nSource: http://localhost:3000/alerting/grafana/e10d1256-082f-4ca3-a936-aceea7759d78/view?orgId=1\nSilence: http://localhost:3000/alerting/silence/new?alertmanager=grafana&matcher=alertname%3DParticipation+Rate+below+80%25&matcher=grafana_folder%3Dnode-alerts&matcher=instance%3D127.0.0.1%3A8080&matcher=job%3Dconsensus-client-job\nDashboard: http://localhost:3000/d/dashboard-id?orgId=1\nPanel: http://localhost:3000/d/dashboard-id?orgId=1&viewPanel=120\n"})})})]}),"\n",(0,s.jsx)(n.h2,{id:"add-message-annotations",children:"Add Message Annotations"}),"\n",(0,s.jsx)(n.p,{children:"First, we have to add custom or additional context to the alert rule, that can later be displayed within our custom message."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Grafana Alert Board",src:t(7333).A+"",width:"1697",height:"819"})}),"\n",(0,s.jsx)(n.admonition,{type:"tip",children:(0,s.jsx)(n.p,{children:"You can further customize the summary and description annotations beyond the default values in the following steps."})}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["Navigate to the ",(0,s.jsx)(n.strong,{children:"Alert Rules"})," from the top right menu of Grafana."]}),"\n",(0,s.jsxs)(n.li,{children:["Edit the Alert Rule by clicking the ",(0,s.jsx)(n.strong,{children:"Edit Icon"})," on the right side of the list."]}),"\n",(0,s.jsxs)(n.li,{children:["Copy the Name and scroll down the ",(0,s.jsx)(n.strong,{children:"Annotations"})," to ",(0,s.jsx)(n.strong,{children:"Configure the Notification Message"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["Choose the ",(0,s.jsx)(n.strong,{children:"Summary"})," annotation and input the previously copied ",(0,s.jsx)(n.strong,{children:"Alert Rule Name"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["Choose the ",(0,s.jsx)(n.strong,{children:"Description"})," annotation and input ",(0,s.jsx)(n.code,{children:"{{ $values.B.Value }}"})," to reference the triggering value."]}),"\n",(0,s.jsx)(n.li,{children:"Safe and Exit the Alert Rule and repeat the process for all the remaining rules."}),"\n"]}),"\n",(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsxs)(n.p,{children:["If you modified the default alert rules that were set up within the ",(0,s.jsx)(n.a,{href:"/docs/guides/alert-systems/grafana-notifications",children:(0,s.jsx)(n.strong,{children:"Grafana Notifications"})}),", you can exchange the referenced value with ",(0,s.jsx)(n.code,{children:"{{ $values.C.Value }}"})," or ",(0,s.jsx)(n.code,{children:"{{ $values.D.Value }}"})," depending on the applied rules at the top of the page."]})}),"\n",(0,s.jsx)(n.h2,{id:"edit-contact-point-message",children:"Edit Contact Point Message"}),"\n",(0,s.jsx)(n.p,{children:"Once your alert rules are filled, you have to customize how the messages are sent via contact points. In Grafana, contact points aggregate the alert rules and manage how it's data is delivered through your notification setup. Using contact points, you have the chance to write fully customized messages and texts depending on what data is abailable or which rule is triggered."}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["Navigate to the ",(0,s.jsx)(n.strong,{children:"Contact Points"})," from the top right menu of Grafana."]}),"\n",(0,s.jsxs)(n.li,{children:["Edit your ",(0,s.jsx)(n.a,{href:"/docs/guides/alert-systems/telegram-bot",children:(0,s.jsx)(n.strong,{children:"Telegram Contact Point"})})," by clicking the ",(0,s.jsx)(n.strong,{children:"Edit Icon"})," on the right side of the list."]}),"\n",(0,s.jsxs)(n.li,{children:["Within the ",(0,s.jsx)(n.strong,{children:"Integration Section"}),", extend the ",(0,s.jsx)(n.strong,{children:"Optional Telegram Settings"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["On the ",(0,s.jsx)(n.strong,{children:"Message"})," heading, click ",(0,s.jsx)(n.strong,{children:"Edit Message"})," to customize your text."]}),"\n",(0,s.jsxs)(n.li,{children:["Click ",(0,s.jsx)(n.em,{children:"Enter Custom Message"})," and paste the following preset, then hit safe"]}),"\n",(0,s.jsxs)(n.li,{children:["On the ",(0,s.jsx)(n.strong,{children:"Contact Point Page"}),", click ",(0,s.jsx)(n.strong,{children:"Safe Contact Point"}),"."]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-text",children:"{{ range .Alerts }}\nLUKSO Alert Rule is: {{ .Status }}\nSummary: {{ .Annotations.summary }}\nValue: {{ .Annotations.description }}\n{{ end }}\n"})}),"\n",(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsxs)(n.p,{children:["If you want to test messages, you can use the ",(0,s.jsx)(n.strong,{children:"Test Icon"})," on the ",(0,s.jsx)(n.strong,{children:"Contact Point Page"})," to send example notifications. To test the ",(0,s.jsx)(n.strong,{children:"Alert Rules"})," in production, you can modify a metric so it is triggered Immediately and sends off a message."]})}),"\n",(0,s.jsx)(n.p,{children:"Your updated Telegram Messages will now look like the following:"}),"\n",(0,s.jsxs)(o.A,{groupId:"message",children:[(0,s.jsx)(i.A,{value:"firing",label:"New Firing Message",default:!0,children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-text",children:"LUKSO Alert Rule is firing\nSummary: Disk Usage above 60%\nValue: 0.7462574211663442\n"})})}),(0,s.jsx)(i.A,{value:"resolved",label:"New Resolved Message",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-text",children:"LUKSO Alert Rule is resolved\nSummary: Disk Usage above 60%\nValue: 0.2462574211663442\n"})})})]}),"\n",(0,s.jsx)(n.admonition,{type:"tip",children:(0,s.jsxs)(n.p,{children:["Further message templates and customization options can be found on the ",(0,s.jsx)(n.a,{href:"https://grafana.com/docs/grafana/latest/alerting/configure-notifications/manage-contact-points/",children:(0,s.jsx)(n.strong,{children:"Grafana Contact Points Documentation"})}),"."]})})]})}function g(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}},9365(e,n,t){t.d(n,{A:()=>o});t(6540);var a=t(4164);const s="tabItem_Ymn6";var r=t(4848);function o({children:e,hidden:n,className:t}){return(0,r.jsx)("div",{role:"tabpanel",className:(0,a.A)(s,t),hidden:n,children:e})}},1470(e,n,t){t.d(n,{A:()=>C});var a=t(6540),s=t(4164),r=t(7559),o=t(3104),i=t(6347),l=t(205),c=t(7485),d=t(1682),u=t(679);function h(e){return a.Children.toArray(e).filter(e=>"\n"!==e).map(e=>{if(!e||(0,a.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})?.filter(Boolean)??[]}function g(e){const{values:n,children:t}=e;return(0,a.useMemo)(()=>{const e=n??function(e){return h(e).map(({props:{value:e,label:n,attributes:t,default:a}})=>({value:e,label:n,attributes:t,default:a}))}(t);return function(e){const n=(0,d.XI)(e,(e,n)=>e.value===n.value);if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map(e=>e.value).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e},[n,t])}function m({value:e,tabValues:n}){return n.some(n=>n.value===e)}function p({queryString:e=!1,groupId:n}){const t=(0,i.W6)(),s=function({queryString:e=!1,groupId:n}){if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:e,groupId:n});return[(0,c.aZ)(s),(0,a.useCallback)(e=>{if(!s)return;const n=new URLSearchParams(t.location.search);n.set(s,e),t.replace({...t.location,search:n.toString()})},[s,t])]}function f(e){const{defaultValue:n,queryString:t=!1,groupId:s}=e,r=g(e),[o,i]=(0,a.useState)(()=>function({defaultValue:e,tabValues:n}){if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!m({value:e,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${n.map(e=>e.value).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}const t=n.find(e=>e.default)??n[0];if(!t)throw new Error("Unexpected error: 0 tabValues");return t.value}({defaultValue:n,tabValues:r})),[c,d]=p({queryString:t,groupId:s}),[h,f]=function({groupId:e}){const n=function(e){return e?`docusaurus.tab.${e}`:null}(e),[t,s]=(0,u.Dv)(n);return[t,(0,a.useCallback)(e=>{n&&s.set(e)},[n,s])]}({groupId:s}),x=(()=>{const e=c??h;return m({value:e,tabValues:r})?e:null})();(0,l.A)(()=>{x&&i(x)},[x]);return{selectedValue:o,selectValue:(0,a.useCallback)(e=>{if(!m({value:e,tabValues:r}))throw new Error(`Can't select invalid tab value=${e}`);i(e),d(e),f(e)},[d,f,r]),tabValues:r}}var x=t(2303);const b="tabList__CuJ",j="tabItem_LNqP";var v=t(4848);function y({className:e,block:n,selectedValue:t,selectValue:a,tabValues:r}){const i=[],{blockElementScrollPositionUntilNextRender:l}=(0,o.a_)(),c=e=>{const n=e.currentTarget,s=i.indexOf(n),o=r[s].value;o!==t&&(l(n),a(o))},d=e=>{let n=null;switch(e.key){case"Enter":c(e);break;case"ArrowRight":{const t=i.indexOf(e.currentTarget)+1;n=i[t]??i[0];break}case"ArrowLeft":{const t=i.indexOf(e.currentTarget)-1;n=i[t]??i[i.length-1];break}}n?.focus()};return(0,v.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,s.A)("tabs",{"tabs--block":n},e),children:r.map(({value:e,label:n,attributes:a})=>(0,v.jsx)("li",{role:"tab",tabIndex:t===e?0:-1,"aria-selected":t===e,ref:e=>{i.push(e)},onKeyDown:d,onClick:c,...a,className:(0,s.A)("tabs__item",j,a?.className,{"tabs__item--active":t===e}),children:n??e},e))})}function w({lazy:e,children:n,selectedValue:t}){const r=(Array.isArray(n)?n:[n]).filter(Boolean);if(e){const e=r.find(e=>e.props.value===t);return e?(0,a.cloneElement)(e,{className:(0,s.A)("margin-top--md",e.props.className)}):null}return(0,v.jsx)("div",{className:"margin-top--md",children:r.map((e,n)=>(0,a.cloneElement)(e,{key:n,hidden:e.props.value!==t}))})}function A(e){const n=f(e);return(0,v.jsxs)("div",{className:(0,s.A)(r.G.tabs.container,"tabs-container",b),children:[(0,v.jsx)(y,{...n,...e}),(0,v.jsx)(w,{...n,...e})]})}function C(e){const n=(0,x.A)();return(0,v.jsx)(A,{...e,children:h(e.children)},String(n))}},7333(e,n,t){t.d(n,{A:()=>a});const a=t.p+"assets/images/grafana-alerts-1-1391fa8b4a87b8bd421b078da6ae088d.png"},8453(e,n,t){t.d(n,{R:()=>o,x:()=>i});var a=t(6540);const s={},r=a.createContext(s);function o(e){const n=a.useContext(r);return a.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),a.createElement(r.Provider,{value:n},e.children)}}}]);