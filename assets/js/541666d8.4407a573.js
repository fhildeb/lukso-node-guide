"use strict";(globalThis.webpackChunklukso_node_guide=globalThis.webpackChunklukso_node_guide||[]).push([[3421],{744(e,n,s){s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>d,default:()=>p,frontMatter:()=>l,metadata:()=>t,toc:()=>h});const t=JSON.parse('{"id":"guides/ssh-setup/authentication","title":"5.3 Authentication","description":"Secure your LUKSO node by enforcing SSH key-based authentication and disabling password logins. Learn how to configure and verify your SSH access settings.","source":"@site/docs/guides/ssh-setup/authentication.md","sourceDirName":"guides/ssh-setup","slug":"/guides/ssh-setup/authentication","permalink":"/docs/guides/ssh-setup/authentication","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_label":"5.3 Authentication","sidebar_position":3,"description":"Secure your LUKSO node by enforcing SSH key-based authentication and disabling password logins. Learn how to configure and verify your SSH access settings."},"sidebar":"guidesSidebar","previous":{"title":"5.2 Key Login","permalink":"/docs/guides/ssh-setup/key-login"},"next":{"title":"6.1 Firewall Settings","permalink":"/docs/guides/client-setup/firewall-settings"}}');var i=s(4848),r=s(8453),o=s(1470),a=s(9365);const l={sidebar_label:"5.3 Authentication",sidebar_position:3,description:"Secure your LUKSO node by enforcing SSH key-based authentication and disabling password logins. Learn how to configure and verify your SSH access settings."},d="5.3 Authentication",c={},h=[{value:"1. Enable Secure Authentication",id:"1-enable-secure-authentication",level:2},{value:"2. Testing Password Login",id:"2-testing-password-login",level:2},{value:"3. Update SSH Login Key",id:"3-update-ssh-login-key",level:2},{value:"4. Testing Key Login",id:"4-testing-key-login",level:2}];function u(e){const n={admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components},{Details:s}=n;return s||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"53-authentication",children:"5.3 Authentication"})}),"\n",(0,i.jsx)(n.p,{children:"In this section, you will lock down SSH on the node to accept only key\u2011based logins. We will adjust the config file, test that password logins are disabled, and update your personal computer's configuration file to include your private key for automated authentication."}),"\n",(0,i.jsx)(n.admonition,{type:"info",children:(0,i.jsxs)(n.p,{children:["The following steps are performed on your \ud83d\udcdf ",(0,i.jsx)(n.strong,{children:"node server"}),"."]})}),"\n",(0,i.jsx)(n.h2,{id:"1-enable-secure-authentication",children:"1. Enable Secure Authentication"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"1.1 Open the Configuration File"}),": ",(0,i.jsx)(n.em,{children:"Open the SSH daemon's file with your preferred text editor."})]}),"\n",(0,i.jsxs)(o.A,{children:[(0,i.jsx)(a.A,{value:"vim",label:"Vim",default:!0,children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:"sudo vim /etc/ssh/sshd_config\n"})})}),(0,i.jsx)(a.A,{value:"nano",label:"Nano",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:"sudo nano /etc/ssh/sshd_config\n"})})})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"1.2 Locate the Settings"}),": ",(0,i.jsx)(n.em,{children:"Search for specific setting entries that are inactive by default."})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",children:"#PermitRootLogin prohibit-password\n\n#PubkeyAuthentication yes\n\n#AuthorizedKeysFile .ssh/authorized_keys ./ssh/authored_keys2\n\n#PasswordAuthentication yes\n#PermitEmptyPasswords no\n\n#KbdInteractiveAuthentication no\n"})}),"\n",(0,i.jsxs)(s,{children:[(0,i.jsx)("summary",{children:"Full Property Explanation"}),(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:(0,i.jsx)(n.strong,{children:"Directive"})}),(0,i.jsx)(n.th,{children:(0,i.jsx)(n.strong,{children:"Description"})}),(0,i.jsx)(n.th,{children:(0,i.jsx)(n.strong,{children:"Value"})})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"PermitRootLogin"}),(0,i.jsx)(n.td,{children:"Allows root login by public\u2011key only, not by password."}),(0,i.jsx)(n.td,{children:"prohibit-password"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"PubkeyAuthentication"}),(0,i.jsx)(n.td,{children:"Enables authentication with authorized public keys."}),(0,i.jsx)(n.td,{children:"yes"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"AuthorizedKeysFile"}),(0,i.jsx)(n.td,{children:"Specifies the single file to read for valid public keys."}),(0,i.jsx)(n.td,{children:".ssh/authorized_keys"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"PasswordAuthentication"}),(0,i.jsx)(n.td,{children:"Disables login with a password entirely."}),(0,i.jsx)(n.td,{children:"no"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"PermitEmptyPasswords"}),(0,i.jsx)(n.td,{children:"Ensures accounts with blank passwords cannot log in."}),(0,i.jsx)(n.td,{children:"no"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"KbdInteractiveAuthentication"}),(0,i.jsx)(n.td,{children:"Disables challenge\u2013response authentication methods."}),(0,i.jsx)(n.td,{children:"no"})]})]})]})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"1.3 Update the Settings"}),": ",(0,i.jsx)(n.em,{children:"Uncomment the entries and change their values."})]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Remove any leading ",(0,i.jsx)(n.em,{children:"#"})," to uncomment each line."]}),"\n",(0,i.jsxs)(n.li,{children:["Set ",(0,i.jsx)(n.em,{children:"PasswordAuthentication"})," no."]}),"\n",(0,i.jsxs)(n.li,{children:["Ensure only the first ",(0,i.jsx)(n.em,{children:"AuthorizedKeysFile"})," entry remains."]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"1.4 Verify the Changes"}),": ",(0,i.jsx)(n.em,{children:"Check for spelling mistakes or unneeded spaces."})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",children:"PermitRootLogin prohibit-password\n...\nPubkeyAuthentication yes\n...\nAuthorizedKeysFile .ssh/authorized_keys\n...\nPasswordAuthentication no\nPermitEmptyPasswords no\n...\nKbdInteractiveAuthentication no\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"1.5 Save and Exit"}),": ",(0,i.jsx)(n.em,{children:"Apply changes and close the file."})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"1.6 Test the new Configuration"}),": ",(0,i.jsx)(n.em,{children:"Validate your file changes using the SSH daemon. A blank output indicates no syntax errors."})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:"sudo sshd -t\n"})}),"\n",(0,i.jsx)(n.admonition,{type:"danger",children:(0,i.jsx)(n.p,{children:"Testing is crucial as you cannot use the regular password login after applying the changes on the main service."})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"1.7 Restart the Service"}),": ",(0,i.jsx)(n.em,{children:"Restart the running SSH daemon for the new adjustments to take effect."})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:"sudo systemctl restart sshd\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"1.8 Log Out of the Node"}),": ",(0,i.jsx)(n.em,{children:"Exit the node's terminal and SSH session."})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:"exit\n"})}),"\n",(0,i.jsx)(n.h2,{id:"2-testing-password-login",children:"2. Testing Password Login"}),"\n",(0,i.jsx)(n.admonition,{type:"info",children:(0,i.jsxs)(n.p,{children:["The following steps are performed on your \ud83d\udcbb ",(0,i.jsx)(n.strong,{children:"personal computer"}),"."]})}),"\n",(0,i.jsx)(n.p,{children:"Attempt to SSH with your user password to confirm it is now disabled:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:"ssh <ssh-device-alias>\n"})}),"\n",(0,i.jsx)(n.admonition,{type:"info",children:(0,i.jsxs)(n.p,{children:["Exchange ",(0,i.jsx)(n.code,{children:"<ssh-device-alias"})," with your actual SSH device name of the node."]})}),"\n",(0,i.jsx)(n.p,{children:"You should see:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:"ssh: connect to host <ssh-device-alias> port 22: Connection refused\n"})}),"\n",(0,i.jsx)(n.admonition,{type:"warning",children:(0,i.jsx)(n.p,{children:"If you can still log in with a password, verify your configuration file again."})}),"\n",(0,i.jsx)(n.h2,{id:"3-update-ssh-login-key",children:"3. Update SSH Login Key"}),"\n",(0,i.jsx)(n.p,{children:"To connect to your node again, we need to add the previously generated SSH key to the SSH client."}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"3.1 Open the Configuration File"}),": ",(0,i.jsx)(n.em,{children:"Open the SSH client's file with your preferred text editor."})]}),"\n",(0,i.jsxs)(o.A,{children:[(0,i.jsx)(a.A,{value:"vim",label:"Vim",default:!0,children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:"vim ~/.ssh/config\n"})})}),(0,i.jsx)(a.A,{value:"nano",label:"Nano",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:"nano ~/.ssh/config\n"})})})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"3.2 Add the Identity Reference"}),": ",(0,i.jsx)(n.em,{children:"Under the host block of your node, add your private key."})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",children:"  IdentityFile ~/.ssh/<chosen-keyname>\n"})}),"\n",(0,i.jsx)(n.admonition,{type:"info",children:(0,i.jsxs)(n.p,{children:["Ensure that your ",(0,i.jsx)(n.code,{children:"IdentityFile"})," points to your private ",(0,i.jsx)(n.code,{children:"<chosen-keyname>"})," without the ",(0,i.jsx)(n.code,{children:".pub"})," extension behind its name."]})}),"\n",(0,i.jsx)(n.p,{children:"The final host block should look like this:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",children:"Host <ssh-device-alias>\n  User <node-username>\n  HostName <node-ip>\n  Port <ssh-port>\n  IdentityFile ~/.ssh/<chosen-keyname>\n"})}),"\n",(0,i.jsx)(n.admonition,{type:"info",children:(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"<ssh-device-alias>"}),": your nodes SSH device name"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"<node-username>"}),": your node's username"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"<node-ip-address>"}),": your node's static IP address"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"<ssh-port>"}),": your opened port number"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"<chosen-keyname>"}),": your SSH key"]}),"\n"]})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"3.3 Save and Exit"}),": ",(0,i.jsx)(n.em,{children:"Apply changes and close the file."})]}),"\n",(0,i.jsx)(n.h2,{id:"4-testing-key-login",children:"4. Testing Key Login"}),"\n",(0,i.jsx)(n.p,{children:"Now connect using your SSH alias:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:"ssh <ssh-device-alias>\n"})}),"\n",(0,i.jsx)(n.p,{children:"After entering the correct passphrase, you will end up on the Ubuntu server welcoming printout."}),"\n",(0,i.jsx)(n.admonition,{type:"info",children:(0,i.jsx)(n.p,{children:"Instead, of the password promt, the SSH client should ask to encrypt the private key with the passphrase."})}),"\n",(0,i.jsx)(n.admonition,{type:"tip",children:(0,i.jsx)(n.p,{children:"If you did not set up any password for the key, you will connect automatically."})})]})}function p(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(u,{...e})}):u(e)}},9365(e,n,s){s.d(n,{A:()=>o});s(6540);var t=s(4164);const i="tabItem_Ymn6";var r=s(4848);function o({children:e,hidden:n,className:s}){return(0,r.jsx)("div",{role:"tabpanel",className:(0,t.A)(i,s),hidden:n,children:e})}},1470(e,n,s){s.d(n,{A:()=>k});var t=s(6540),i=s(4164),r=s(7559),o=s(3104),a=s(6347),l=s(205),d=s(7485),c=s(1682),h=s(679);function u(e){return t.Children.toArray(e).filter(e=>"\n"!==e).map(e=>{if(!e||(0,t.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})?.filter(Boolean)??[]}function p(e){const{values:n,children:s}=e;return(0,t.useMemo)(()=>{const e=n??function(e){return u(e).map(({props:{value:e,label:n,attributes:s,default:t}})=>({value:e,label:n,attributes:s,default:t}))}(s);return function(e){const n=(0,c.XI)(e,(e,n)=>e.value===n.value);if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map(e=>e.value).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e},[n,s])}function x({value:e,tabValues:n}){return n.some(n=>n.value===e)}function g({queryString:e=!1,groupId:n}){const s=(0,a.W6)(),i=function({queryString:e=!1,groupId:n}){if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:e,groupId:n});return[(0,d.aZ)(i),(0,t.useCallback)(e=>{if(!i)return;const n=new URLSearchParams(s.location.search);n.set(i,e),s.replace({...s.location,search:n.toString()})},[i,s])]}function j(e){const{defaultValue:n,queryString:s=!1,groupId:i}=e,r=p(e),[o,a]=(0,t.useState)(()=>function({defaultValue:e,tabValues:n}){if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!x({value:e,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${n.map(e=>e.value).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}const s=n.find(e=>e.default)??n[0];if(!s)throw new Error("Unexpected error: 0 tabValues");return s.value}({defaultValue:n,tabValues:r})),[d,c]=g({queryString:s,groupId:i}),[u,j]=function({groupId:e}){const n=function(e){return e?`docusaurus.tab.${e}`:null}(e),[s,i]=(0,h.Dv)(n);return[s,(0,t.useCallback)(e=>{n&&i.set(e)},[n,i])]}({groupId:i}),m=(()=>{const e=d??u;return x({value:e,tabValues:r})?e:null})();(0,l.A)(()=>{m&&a(m)},[m]);return{selectedValue:o,selectValue:(0,t.useCallback)(e=>{if(!x({value:e,tabValues:r}))throw new Error(`Can't select invalid tab value=${e}`);a(e),c(e),j(e)},[c,j,r]),tabValues:r}}var m=s(2303);const y="tabList__CuJ",f="tabItem_LNqP";var b=s(4848);function v({className:e,block:n,selectedValue:s,selectValue:t,tabValues:r}){const a=[],{blockElementScrollPositionUntilNextRender:l}=(0,o.a_)(),d=e=>{const n=e.currentTarget,i=a.indexOf(n),o=r[i].value;o!==s&&(l(n),t(o))},c=e=>{let n=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":{const s=a.indexOf(e.currentTarget)+1;n=a[s]??a[0];break}case"ArrowLeft":{const s=a.indexOf(e.currentTarget)-1;n=a[s]??a[a.length-1];break}}n?.focus()};return(0,b.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,i.A)("tabs",{"tabs--block":n},e),children:r.map(({value:e,label:n,attributes:t})=>(0,b.jsx)("li",{role:"tab",tabIndex:s===e?0:-1,"aria-selected":s===e,ref:e=>{a.push(e)},onKeyDown:c,onClick:d,...t,className:(0,i.A)("tabs__item",f,t?.className,{"tabs__item--active":s===e}),children:n??e},e))})}function w({lazy:e,children:n,selectedValue:s}){const r=(Array.isArray(n)?n:[n]).filter(Boolean);if(e){const e=r.find(e=>e.props.value===s);return e?(0,t.cloneElement)(e,{className:(0,i.A)("margin-top--md",e.props.className)}):null}return(0,b.jsx)("div",{className:"margin-top--md",children:r.map((e,n)=>(0,t.cloneElement)(e,{key:n,hidden:e.props.value!==s}))})}function S(e){const n=j(e);return(0,b.jsxs)("div",{className:(0,i.A)(r.G.tabs.container,"tabs-container",y),children:[(0,b.jsx)(v,{...n,...e}),(0,b.jsx)(w,{...n,...e})]})}function k(e){const n=(0,m.A)();return(0,b.jsx)(S,{...e,children:u(e.children)},String(n))}},8453(e,n,s){s.d(n,{R:()=>o,x:()=>a});var t=s(6540);const i={},r=t.createContext(i);function o(e){const n=t.useContext(r);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);