"use strict";(self.webpackChunklukso_node_guide=self.webpackChunklukso_node_guide||[]).push([[3968],{1470:(e,n,s)=>{s.d(n,{A:()=>w});var r=s(6540),t=s(4164),i=s(3104),o=s(6347),l=s(205),a=s(7485),d=s(1682),c=s(679);function u(e){return r.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,r.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function h(e){const{values:n,children:s}=e;return(0,r.useMemo)((()=>{const e=n??function(e){return u(e).map((({props:{value:e,label:n,attributes:s,default:r}})=>({value:e,label:n,attributes:s,default:r})))}(s);return function(e){const n=(0,d.XI)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[n,s])}function p({value:e,tabValues:n}){return n.some((n=>n.value===e))}function m({queryString:e=!1,groupId:n}){const s=(0,o.W6)(),t=function({queryString:e=!1,groupId:n}){if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:e,groupId:n});return[(0,a.aZ)(t),(0,r.useCallback)((e=>{if(!t)return;const n=new URLSearchParams(s.location.search);n.set(t,e),s.replace({...s.location,search:n.toString()})}),[t,s])]}function x(e){const{defaultValue:n,queryString:s=!1,groupId:t}=e,i=h(e),[o,a]=(0,r.useState)((()=>function({defaultValue:e,tabValues:n}){if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!p({value:e,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${n.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}const s=n.find((e=>e.default))??n[0];if(!s)throw new Error("Unexpected error: 0 tabValues");return s.value}({defaultValue:n,tabValues:i}))),[d,u]=m({queryString:s,groupId:t}),[x,g]=function({groupId:e}){const n=function(e){return e?`docusaurus.tab.${e}`:null}(e),[s,t]=(0,c.Dv)(n);return[s,(0,r.useCallback)((e=>{n&&t.set(e)}),[n,t])]}({groupId:t}),f=(()=>{const e=d??x;return p({value:e,tabValues:i})?e:null})();(0,l.A)((()=>{f&&a(f)}),[f]);return{selectedValue:o,selectValue:(0,r.useCallback)((e=>{if(!p({value:e,tabValues:i}))throw new Error(`Can't select invalid tab value=${e}`);a(e),u(e),g(e)}),[u,g,i]),tabValues:i}}var g=s(2303);const f={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var j=s(4848);function b({className:e,block:n,selectedValue:s,selectValue:r,tabValues:o}){const l=[],{blockElementScrollPositionUntilNextRender:a}=(0,i.a_)(),d=e=>{const n=e.currentTarget,t=l.indexOf(n),i=o[t].value;i!==s&&(a(n),r(i))},c=e=>{let n=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":{const s=l.indexOf(e.currentTarget)+1;n=l[s]??l[0];break}case"ArrowLeft":{const s=l.indexOf(e.currentTarget)-1;n=l[s]??l[l.length-1];break}}n?.focus()};return(0,j.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,t.A)("tabs",{"tabs--block":n},e),children:o.map((({value:e,label:n,attributes:r})=>(0,j.jsx)("li",{role:"tab",tabIndex:s===e?0:-1,"aria-selected":s===e,ref:e=>{l.push(e)},onKeyDown:c,onClick:d,...r,className:(0,t.A)("tabs__item",f.tabItem,r?.className,{"tabs__item--active":s===e}),children:n??e},e)))})}function v({lazy:e,children:n,selectedValue:s}){const i=(Array.isArray(n)?n:[n]).filter(Boolean);if(e){const e=i.find((e=>e.props.value===s));return e?(0,r.cloneElement)(e,{className:(0,t.A)("margin-top--md",e.props.className)}):null}return(0,j.jsx)("div",{className:"margin-top--md",children:i.map(((e,n)=>(0,r.cloneElement)(e,{key:n,hidden:e.props.value!==s})))})}function y(e){const n=x(e);return(0,j.jsxs)("div",{className:(0,t.A)("tabs-container",f.tabList),children:[(0,j.jsx)(b,{...n,...e}),(0,j.jsx)(v,{...n,...e})]})}function w(e){const n=(0,g.A)();return(0,j.jsx)(y,{...e,children:u(e.children)},String(n))}},8453:(e,n,s)=>{s.d(n,{R:()=>o,x:()=>l});var r=s(6540);const t={},i=r.createContext(t);function o(e){const n=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),r.createElement(i.Provider,{value:n},e.children)}},9365:(e,n,s)=>{s.d(n,{A:()=>o});s(6540);var r=s(4164);const t={tabItem:"tabItem_Ymn6"};var i=s(4848);function o({children:e,hidden:n,className:s}){return(0,i.jsx)("div",{role:"tabpanel",className:(0,r.A)(t.tabItem,s),hidden:n,children:e})}},9842:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>d,default:()=>p,frontMatter:()=>a,metadata:()=>r,toc:()=>u});const r=JSON.parse('{"id":"guides/maintenance/revert-client-versions","title":"11.4 Revert Client Versions","description":"Learn how to safely downgrade LUKSO execution and consensus clients to previous versions for improved node stability and compatibility.","source":"@site/docs/guides/maintenance/revert-client-versions.md","sourceDirName":"guides/maintenance","slug":"/guides/maintenance/revert-client-versions","permalink":"/docs/guides/maintenance/revert-client-versions","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_label":"11.4 Revert Client Versions","sidebar_position":4,"description":"Learn how to safely downgrade LUKSO execution and consensus clients to previous versions for improved node stability and compatibility."},"sidebar":"guidesSidebar","previous":{"title":"11.3 Problem Scanning","permalink":"/docs/guides/maintenance/problem-scanning"},"next":{"title":"11.5 Switch Clients","permalink":"/docs/guides/maintenance/switch-clients"}}');var t=s(4848),i=s(8453),o=s(1470),l=s(9365);const a={sidebar_label:"11.4 Revert Client Versions",sidebar_position:4,description:"Learn how to safely downgrade LUKSO execution and consensus clients to previous versions for improved node stability and compatibility."},d="11.4 Revert Client Versions",c={},u=[{value:"1. Stop Node Operation",id:"1-stop-node-operation",level:2},{value:"2. Install Custom Version",id:"2-install-custom-version",level:2},{value:"3. Restart the Node",id:"3-restart-the-node",level:2}];function h(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components},{Details:s}=n;return s||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"114-revert-client-versions",children:"11.4 Revert Client Versions"})}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.a,{href:"https://github.com/lukso-network/tools-lukso-cli",children:"LUKSO CLI"})," allows to downgrade clients to an earlier version below the latest supported one. This might solve potential stability, database, or configuration issues that happen after an upgrade or maintenance. However, keep in mind that older versions must feature support for the latest ",(0,t.jsx)(n.a,{href:"/docs/archive/network/network-forks",children:"network fork"})," to keep up with the current chain head and stake funds."]}),"\n",(0,t.jsx)(n.admonition,{type:"info",children:(0,t.jsxs)(n.p,{children:["The following steps are performed on your \ud83d\udcdf ",(0,t.jsx)(n.strong,{children:"node server"}),"."]})}),"\n",(0,t.jsx)(n.h2,{id:"1-stop-node-operation",children:"1. Stop Node Operation"}),"\n",(0,t.jsx)(n.p,{children:"Depending on your setup method, there are different ways to stop your node before applying updates."}),"\n",(0,t.jsxs)(o.A,{groupId:"setup",children:[(0,t.jsxs)(l.A,{value:"cli",label:"LUKSO CLI",default:!0,children:[(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:"cd <lukso-working-directory>\nlukso stop\n"})}),(0,t.jsx)(n.admonition,{type:"info",children:(0,t.jsxs)(n.p,{children:["Exchange ",(0,t.jsx)(n.code,{children:"<lukso-working-directory>"})," with the path of the node folder."]})})]}),(0,t.jsx)(l.A,{value:"automation",label:"Service Automation",children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:"sudo systemctl stop lukso-validator\n"})})})]}),"\n",(0,t.jsxs)(s,{children:[(0,t.jsx)("summary",{children:"Force Client Shutdown"}),(0,t.jsxs)(o.A,{children:[(0,t.jsx)(l.A,{value:"geth",label:"Geth",children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:"sudo pkill geth\n"})})}),(0,t.jsx)(l.A,{value:"erigon",label:"Erigon",children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:"sudo pkill erigon\n"})})}),(0,t.jsx)(l.A,{value:"nethermind",label:"Nethermind",children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:"sudo pkill nethermind\n"})})}),(0,t.jsx)(l.A,{value:"besu",label:"Besu",children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:"sudo pkill besu\n"})})}),(0,t.jsx)(l.A,{value:"teku",label:"Teku",children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:"sudo pkill teku\n"})})}),(0,t.jsx)(l.A,{value:"nimbus2",label:"Nimbus-Eth2",children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:"sudo pkill nimbus_beacon_node\nsudo pkill nimbus_validator_client\n"})})}),(0,t.jsxs)(l.A,{value:"lighthouse",label:"Lighthouse",children:[(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:"sudo pkill lighthouse\n"})}),(0,t.jsx)(n.admonition,{type:"tip",children:(0,t.jsx)(n.p,{children:"The Lighthouse client uses a single binary for both the consensus and validator processes."})})]}),(0,t.jsx)(l.A,{value:"prysm",label:"Prysm",children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:"sudo pkill prysm\nsudo pkill validator\n"})})})]})]}),"\n",(0,t.jsx)(n.h2,{id:"2-install-custom-version",children:"2. Install Custom Version"}),"\n",(0,t.jsx)(n.p,{children:"Custom client versions can be installed using the regular installation command with additional flags. The terminal interface will give you the option to choose your execution and consensus client and will download the specified version from the flags. Multiple flags can be attached to install a custom consensus and execution client version simultaneously."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:"# Overwrite default Geth Version\nlukso install --geth-tag 1.12.2 --geth-commit-hash bed84606\n\n# Overwrite default Erigon Version\nlukso install --erigon-tag 2.52.1\n\n# Overwrite default Besu Version\nlukso install --besu-tag 24.5.1\n\n# Overwrite default Nethermind Version\nlukso install --nethermind-tag v1.22.0 --nethermind-commit-hash ae444a4\n\n# Overwrite default Prysm Version\nlukso install --prysm-tag v4.0.8\n\n# Overwrite default Lighthouse Version\nlukso install --lighthouse-tag v4.1.0\n\n# Overwrite default Teku Version\nlukso install --teku-tag v23.10.0\n\n# Overwrite default Nimbus-Eth2 Version\nlukso install --nimbus2-tag v24.2.1 --nimbus2-commit-hash 7fe43fc\n"})}),"\n",(0,t.jsx)(n.admonition,{type:"tip",children:(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.strong,{children:"Geth"}),", ",(0,t.jsx)(n.strong,{children:"Nethermind"}),", and ",(0,t.jsx)(n.strong,{children:"Nimbus-Eth2"})," clients require an additional commit hash to the release tag, both attached as flags."]})}),"\n",(0,t.jsx)(n.admonition,{type:"warning",children:(0,t.jsx)(n.p,{children:"Each release tag has different version formatting. Ensure you are using the correct format as shown in above examples."})}),"\n",(0,t.jsxs)(n.admonition,{type:"info",children:[(0,t.jsx)(n.p,{children:"Version numbers and commit hashes can be derived from the client repositories:"}),(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://github.com/ethereum/go-ethereum/releases",children:"Geth Releases"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://github.com/ledgerwatch/erigon/releases",children:"Erigon Releases"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://github.com/hyperledger/besu/releases",children:"Besu Releases"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://github.com/nethermindeth/nethermind/releases",children:"Nethermind Releases"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://github.com/prysmaticlabs/prysm/releases",children:"Prysm Releases"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://github.com/sigp/lighthouse/releases",children:"Lighthouse Releases"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://github.com/ConsenSys/teku/releases",children:"Teku Releases"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://github.com/status-im/nimbus-eth2/releases",children:"Nimbus-Eth2 Releases"})}),"\n"]})]}),"\n",(0,t.jsx)(n.h2,{id:"3-restart-the-node",children:"3. Restart the Node"}),"\n",(0,t.jsx)(n.p,{children:"Depending on your setup method, there are different ways to start your node after custom versions have been installed."}),"\n",(0,t.jsxs)(o.A,{groupId:"setup",children:[(0,t.jsxs)(l.A,{value:"clinode",label:"LUKSO CLI Node",default:!0,children:[(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:"cd <lukso-working-directory>\nlukso start --checkpoint-sync\n"})}),(0,t.jsx)(n.admonition,{type:"info",children:(0,t.jsxs)(n.p,{children:["Exchange ",(0,t.jsx)(n.code,{children:"<lukso-working-directory>"})," with the path of the node folder"]})})]}),(0,t.jsxs)(l.A,{value:"clivalidator",label:"LUKSO CLI Validator",default:!0,children:[(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:'cd <lukso-working-directory>\nlukso start --validator --transaction-fee-recipient "<your-fee-recipient-address>" --checkpoint-sync\n'})}),(0,t.jsxs)(n.admonition,{type:"info",children:[(0,t.jsx)(n.p,{children:"The following properties need to be exchanged:"}),(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"<lukso-working-directory>"})," with the path of the node folder"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"<your-fee-recipient-address>"})," with the wallet address receiving staking profits"]}),"\n"]})]})]}),(0,t.jsxs)(l.A,{value:"automation",label:"Service Automation",children:[(0,t.jsx)(n.admonition,{type:"warning",children:(0,t.jsx)(n.p,{children:"For improved security, the service automation is started from a separate user with restricted rights. New permissions must be assigned to all data and software folders affected by the previous updates before the node should be restarted."})}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:"sudo chown -R lukso-validator-worker:lukso-validator-worker /home/<user-name>/<lukso-working-directory>\nsudo chown lukso-validator-worker:lukso-validator-worker /usr/local/bin/lukso\nsudo chmod -R 750 /home/<user-name>/<lukso-working-directory>\nsudo chmod 755 /home/<user-name>/<lukso-working-directory>\nsudo chmod 400 /home/<user-name>/<lukso-working-directory>/static/<your-generic-password-file>\nsudo chmod 500 /home/<user-name>/<lukso-working-directory>/static/lukso_startup.sh\n"})}),(0,t.jsxs)(n.admonition,{type:"info",children:[(0,t.jsx)(n.p,{children:"The following properties need to be exchanged:"}),(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"<user-name>"})," with the user name used to login to your node"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"<lukso-working-directory> "})," with the path of the node folder"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"<your-generic-password-file>"})," with the full name of the password file to start the validator"]}),"\n"]})]}),(0,t.jsxs)(s,{children:[(0,t.jsx)("summary",{children:"Full Command Descriptions"}),(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:(0,t.jsx)(n.strong,{children:"Setting"})}),(0,t.jsx)(n.th,{children:(0,t.jsx)(n.strong,{children:"Description"})})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsxs)("nobr",{children:[" ",(0,t.jsx)(n.code,{children:"sudo chown -R <user>:<user> <directory>"})," "]})}),(0,t.jsx)(n.td,{children:"Recursively assign user ownership to all directory contents."})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsxs)("nobr",{children:[" ",(0,t.jsx)(n.code,{children:"sudo chown <user>:<user> <directory>"})," "]})}),(0,t.jsx)(n.td,{children:"Assign ownership to a single folder or file."})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsxs)("nobr",{children:[" ",(0,t.jsx)(n.code,{children:"sudo chmod -R 750 <directory>"})," "]})}),(0,t.jsx)(n.td,{children:"Set executable and readable permissions for a user and group."})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsxs)("nobr",{children:[" ",(0,t.jsx)(n.code,{children:"sudo chmod 755 <directory>"})," "]})}),(0,t.jsx)(n.td,{children:"Set readable permissions for everyone, typically for general files."})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsxs)("nobr",{children:[" ",(0,t.jsx)(n.code,{children:"sudo chmod 400 <directory>/<file>"})," "]})}),(0,t.jsx)(n.td,{children:"Read-only access for owner, typically for secret information."})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsxs)("nobr",{children:[" ",(0,t.jsx)(n.code,{children:"sudo chmod 500 <directory>/<file>"})," "]})}),(0,t.jsx)(n.td,{children:"Executable-only by owner, typically for service scripts."})]})]})]})]}),(0,t.jsx)(n.p,{children:"Once the original rights have been restored, the service can be started."}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:"sudo systemctl start lukso-validator\n"})}),(0,t.jsx)(n.admonition,{type:"warning",children:(0,t.jsx)(n.p,{children:"If the service does not start up, check the service status before and reapply the necessary permissions."})}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:"sudo systemctl status lukso-validator\n"})})]})]}),"\n",(0,t.jsx)(n.p,{children:"After the clients were started, verify that their services are still up."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:"sudo lukso status\n"})}),"\n",(0,t.jsx)(n.admonition,{type:"warning",children:(0,t.jsxs)(n.p,{children:["If you are still running into issues, ",(0,t.jsx)(n.a,{href:"/docs/guides/maintenance/problem-scanning",children:"scan for problems"})," or ",(0,t.jsx)(n.a,{href:"/docs/guides/maintenance/client-updates",children:"update your clients"})," and their specific ",(0,t.jsx)(n.a,{href:"/docs/archive/network/configuration-updates",children:"network configurations"}),"."]})})]})}function p(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(h,{...e})}):h(e)}}}]);