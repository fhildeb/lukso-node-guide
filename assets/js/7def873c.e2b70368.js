"use strict";(self.webpackChunklukso_node_guide=self.webpackChunklukso_node_guide||[]).push([[290],{1470:(e,r,n)=>{n.d(r,{A:()=>w});var t=n(6540),s=n(4164),o=n(7559),i=n(3104),l=n(6347),a=n(205),c=n(7485),d=n(1682),h=n(679);function x(e){return t.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,t.isValidElement)(e)&&function(e){const{props:r}=e;return!!r&&"object"==typeof r&&"value"in r}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function u(e){const{values:r,children:n}=e;return(0,t.useMemo)((()=>{const e=r??function(e){return x(e).map((({props:{value:e,label:r,attributes:n,default:t}})=>({value:e,label:r,attributes:n,default:t})))}(n);return function(e){const r=(0,d.XI)(e,((e,r)=>e.value===r.value));if(r.length>0)throw new Error(`Docusaurus error: Duplicate values "${r.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[r,n])}function p({value:e,tabValues:r}){return r.some((r=>r.value===e))}function b({queryString:e=!1,groupId:r}){const n=(0,l.W6)(),s=function({queryString:e=!1,groupId:r}){if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!r)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return r??null}({queryString:e,groupId:r});return[(0,c.aZ)(s),(0,t.useCallback)((e=>{if(!s)return;const r=new URLSearchParams(n.location.search);r.set(s,e),n.replace({...n.location,search:r.toString()})}),[s,n])]}function j(e){const{defaultValue:r,queryString:n=!1,groupId:s}=e,o=u(e),[i,l]=(0,t.useState)((()=>function({defaultValue:e,tabValues:r}){if(0===r.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!p({value:e,tabValues:r}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${r.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}const n=r.find((e=>e.default))??r[0];if(!n)throw new Error("Unexpected error: 0 tabValues");return n.value}({defaultValue:r,tabValues:o}))),[c,d]=b({queryString:n,groupId:s}),[x,j]=function({groupId:e}){const r=function(e){return e?`docusaurus.tab.${e}`:null}(e),[n,s]=(0,h.Dv)(r);return[n,(0,t.useCallback)((e=>{r&&s.set(e)}),[r,s])]}({groupId:s}),m=(()=>{const e=c??x;return p({value:e,tabValues:o})?e:null})();(0,a.A)((()=>{m&&l(m)}),[m]);return{selectedValue:i,selectValue:(0,t.useCallback)((e=>{if(!p({value:e,tabValues:o}))throw new Error(`Can't select invalid tab value=${e}`);l(e),d(e),j(e)}),[d,j,o]),tabValues:o}}var m=n(2303);const g={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var f=n(4848);function y({className:e,block:r,selectedValue:n,selectValue:t,tabValues:o}){const l=[],{blockElementScrollPositionUntilNextRender:a}=(0,i.a_)(),c=e=>{const r=e.currentTarget,s=l.indexOf(r),i=o[s].value;i!==n&&(a(r),t(i))},d=e=>{let r=null;switch(e.key){case"Enter":c(e);break;case"ArrowRight":{const n=l.indexOf(e.currentTarget)+1;r=l[n]??l[0];break}case"ArrowLeft":{const n=l.indexOf(e.currentTarget)-1;r=l[n]??l[l.length-1];break}}r?.focus()};return(0,f.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,s.A)("tabs",{"tabs--block":r},e),children:o.map((({value:e,label:r,attributes:t})=>(0,f.jsx)("li",{role:"tab",tabIndex:n===e?0:-1,"aria-selected":n===e,ref:e=>{l.push(e)},onKeyDown:d,onClick:c,...t,className:(0,s.A)("tabs__item",g.tabItem,t?.className,{"tabs__item--active":n===e}),children:r??e},e)))})}function v({lazy:e,children:r,selectedValue:n}){const o=(Array.isArray(r)?r:[r]).filter(Boolean);if(e){const e=o.find((e=>e.props.value===n));return e?(0,t.cloneElement)(e,{className:(0,s.A)("margin-top--md",e.props.className)}):null}return(0,f.jsx)("div",{className:"margin-top--md",children:o.map(((e,r)=>(0,t.cloneElement)(e,{key:r,hidden:e.props.value!==n})))})}function k(e){const r=j(e);return(0,f.jsxs)("div",{className:(0,s.A)(o.G.tabs.container,"tabs-container",g.tabList),children:[(0,f.jsx)(y,{...r,...e}),(0,f.jsx)(v,{...r,...e})]})}function w(e){const r=(0,m.A)();return(0,f.jsx)(k,{...e,children:x(e.children)},String(r))}},2162:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>d,contentTitle:()=>c,default:()=>u,frontMatter:()=>a,metadata:()=>t,toc:()=>h});const t=JSON.parse('{"id":"guides/monitoring/blackbox-exporter","title":"8.5 Blackbox Exporter","description":"Set up Blackbox Exporter on your LUKSO node to monitor DNS response times, detect network latency, and ensure reliable uptime tracking.","source":"@site/docs/guides/monitoring/blackbox-exporter.md","sourceDirName":"guides/monitoring","slug":"/guides/monitoring/blackbox-exporter","permalink":"/docs/guides/monitoring/blackbox-exporter","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"sidebar_label":"8.5 Blackbox Exporter","sidebar_position":5,"description":"Set up Blackbox Exporter on your LUKSO node to monitor DNS response times, detect network latency, and ensure reliable uptime tracking."},"sidebar":"guidesSidebar","previous":{"title":"8.4 JSON Exporter","permalink":"/docs/guides/monitoring/json-exporter"},"next":{"title":"8.6 Prometheus","permalink":"/docs/guides/monitoring/prometheus"}}');var s=n(4848),o=n(8453),i=n(1470),l=n(9365);const a={sidebar_label:"8.5 Blackbox Exporter",sidebar_position:5,description:"Set up Blackbox Exporter on your LUKSO node to monitor DNS response times, detect network latency, and ensure reliable uptime tracking."},c="8.5 Blackbox Exporter",d={},h=[{value:"1. Create System User",id:"1-create-system-user",level:2},{value:"2. Install Blackbox Exporter",id:"2-install-blackbox-exporter",level:2},{value:"3. Extend Network Capabilities",id:"3-extend-network-capabilities",level:2},{value:"4. Probing Configuration",id:"4-probing-configuration",level:2},{value:"5. Service Configuration",id:"5-service-configuration",level:2},{value:"6. Start the Exporter Service",id:"6-start-the-exporter-service",level:2},{value:"7. Check Service Status",id:"7-check-service-status",level:2},{value:"Maintenance",id:"maintenance",level:2},{value:"Revert Setup",id:"revert-setup",level:2}];function x(e){const r={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,o.R)(),...e.components},{Details:n}=r;return n||function(e,r){throw new Error("Expected "+(r?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(r.header,{children:(0,s.jsx)(r.h1,{id:"85-blackbox-exporter",children:"8.5 Blackbox Exporter"})}),"\n",(0,s.jsx)(r.p,{children:"The Blackbox Exporter probes server endpoints and monitors the ping time between the node machine and two DNS servers. This information can be crucial in diagnosing network-related issues or delays."}),"\n",(0,s.jsx)(r.admonition,{type:"tip",children:(0,s.jsxs)(r.p,{children:["Further details about node analytics can be found on the ",(0,s.jsx)(r.a,{href:"/docs/theory/node-operation/monitoring-tools",children:(0,s.jsx)(r.strong,{children:"Monitoring Tools"})})," page in the \ud83e\udde0 ",(0,s.jsx)(r.a,{href:"/docs/theory/preparations/node-specifications",children:(0,s.jsx)(r.strong,{children:"Theory"})})," section."]})}),"\n",(0,s.jsx)(r.admonition,{type:"info",children:(0,s.jsxs)(r.p,{children:["The following steps are performed on your \ud83d\udcdf ",(0,s.jsx)(r.strong,{children:"node server"}),"."]})}),"\n",(0,s.jsx)(r.h2,{id:"1-create-system-user",children:"1. Create System User"}),"\n",(0,s.jsx)(r.p,{children:"Running services as a system user with minimal privileges is a best practice, limiting damage if compromised. The Blackbox Exporter user will only be able to read and execute service-specific files. Use the system's user creation tool to add a new one."}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-sh",children:"sudo adduser --system blackbox-exporter-worker --group --no-create-home\n"})}),"\n",(0,s.jsxs)(n,{children:[(0,s.jsx)("summary",{children:"Full Command Explanation"}),(0,s.jsxs)(r.table,{children:[(0,s.jsx)(r.thead,{children:(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.th,{children:"Flag"}),(0,s.jsx)(r.th,{children:"Description"})]})}),(0,s.jsxs)(r.tbody,{children:[(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsxs)("nobr",{children:[" ",(0,s.jsx)(r.code,{children:"--system"})," "]})}),(0,s.jsx)(r.td,{children:"Creates a system user, used to run services and daemons rather than for people to log in with."})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsxs)("nobr",{children:[" ",(0,s.jsx)(r.code,{children:"--group"})," "]})}),(0,s.jsx)(r.td,{children:"Creates a new group with the same name as the user."})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsxs)("nobr",{children:[" ",(0,s.jsx)(r.code,{children:"--no-create-home"})," "]})}),(0,s.jsx)(r.td,{children:"Prevents creation of a home directory since the service does not need one."})]})]})]})]}),"\n",(0,s.jsx)(r.p,{children:"If you want to confirm that the user has been created, you can search for it within the password file, housing all essential information for each user account. Using the search tool grep, we can check if the user exists within the file."}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-sh",children:'grep "blackbox-exporter-worker" /etc/passwd\n'})}),"\n",(0,s.jsx)(r.p,{children:"The output should look similar to this:"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-text",children:"blackbox-exporter-worker:x:116:122::/home/blackbox-exporter-worker:/usr/sbin/nologin\n"})}),"\n",(0,s.jsx)(r.h2,{id:"2-install-blackbox-exporter",children:"2. Install Blackbox Exporter"}),"\n",(0,s.jsx)(r.p,{children:"To add the Blackbox Exporter tool to your node, you have to install it's package."}),"\n",(0,s.jsx)(r.admonition,{type:"tip",children:(0,s.jsxs)(r.p,{children:["Depending on the ",(0,s.jsx)(r.a,{href:"https://github.com/prometheus/blackbox_exporter/releases/",children:"Current Blackbox Exporter Release"})," the version and filenames might differ. Please ensure to use the latest release for best security and stability. As of ",(0,s.jsx)(r.strong,{children:"July 2025"})," it is version ",(0,s.jsx)(r.strong,{children:"0.27.0"}),"."]})}),"\n",(0,s.jsxs)(r.p,{children:[(0,s.jsx)(r.strong,{children:"2.1 Download Archive"}),": Move to the home directory and download the latest version."]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-sh",children:"cd\nwget https://github.com/prometheus/blackbox_exporter/releases/download/v0.27.0/blackbox_exporter-0.27.0.linux-amd64.tar.gz\n"})}),"\n",(0,s.jsxs)(r.p,{children:[(0,s.jsx)(r.strong,{children:"2.2 Extract Files"}),": Unpack the archive using Ubuntu\u2019s archiving tool."]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-sh",children:"tar xzfv blackbox_exporter-0.27.0.linux-amd64.tar.gz\n"})}),"\n",(0,s.jsx)(r.admonition,{type:"info",children:(0,s.jsxs)(r.p,{children:["The ",(0,s.jsx)(r.code,{children:"tar"})," command extracts ",(0,s.jsx)(r.code,{children:"x"})," the uncompressed ",(0,s.jsx)(r.code,{children:"z"})," archive from the file path ",(0,s.jsx)(r.code,{children:"f"})," using verbose ",(0,s.jsx)(r.code,{children:"v"})," status messages."]})}),"\n",(0,s.jsxs)(r.p,{children:[(0,s.jsx)(r.strong,{children:"2.3 Move Binary to System Path"}),": Move the Blackbox Exporter binary to your system path."]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-sh",children:"sudo cp blackbox_exporter-0.27.0.linux-amd64/blackbox_exporter /usr/local/bin/\n"})}),"\n",(0,s.jsxs)(r.p,{children:[(0,s.jsx)(r.strong,{children:"2.4 Set Ownership and Permissions"}),": Set the correct owner and access rights."]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-sh",children:"sudo chown blackbox-exporter-worker:blackbox-exporter-worker /usr/local/bin/blackbox_exporter\nsudo chmod 755 /usr/local/bin/blackbox_exporter\n"})}),"\n",(0,s.jsxs)(r.p,{children:[(0,s.jsx)(r.strong,{children:"2.5 Cleanup Files"}),": Delete leftover archive and extracted folder."]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-sh",children:"rm -rf blackbox_exporter-0.27.0.linux-amd64\nrm blackbox_exporter-0.27.0.linux-amd64.tar.gz\n"})}),"\n",(0,s.jsx)(r.h2,{id:"3-extend-network-capabilities",children:"3. Extend Network Capabilities"}),"\n",(0,s.jsx)(r.p,{children:"The Blackbox Exporter needs raw socket access to perform ping-based probes. Grant this capability:"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-sh",children:"sudo setcap cap_net_raw+ep /usr/local/bin/blackbox_exporter\n"})}),"\n",(0,s.jsxs)(n,{children:[(0,s.jsx)("summary",{children:"Full Command Explanation"}),(0,s.jsxs)(r.table,{children:[(0,s.jsx)(r.thead,{children:(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.th,{children:"Flag"}),(0,s.jsx)(r.th,{children:"Description"})]})}),(0,s.jsxs)(r.tbody,{children:[(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsxs)("nobr",{children:[" ",(0,s.jsx)(r.code,{children:"setcap"})," "]})}),(0,s.jsxs)(r.td,{children:["Sets Linux capabilities on an executable like ",(0,s.jsx)(r.code,{children:"/usr/local/bin/blackbox_exporter"}),"."]})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsxs)("nobr",{children:[" ",(0,s.jsx)(r.code,{children:"cap_net_raw+ep"})," "]})}),(0,s.jsxs)(r.td,{children:["Effectively ",(0,s.jsx)(r.code,{children:"e"})," permitts ",(0,s.jsx)(r.code,{children:"p"})," the capability to use raw and packet network sockets."]})]})]})]})]}),"\n",(0,s.jsx)(r.h2,{id:"4-probing-configuration",children:"4. Probing Configuration"}),"\n",(0,s.jsx)(r.p,{children:"Create a configuration file that will be used for the pings from the node to the servers."}),"\n",(0,s.jsxs)(r.p,{children:[(0,s.jsx)(r.strong,{children:"4.1 Create Config Directory and File"}),": Choose a separate folder and create a config file using your preferred text editor."]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-sh",children:"sudo mkdir /etc/blackbox_exporter/\n"})}),"\n",(0,s.jsxs)(i.A,{groupId:"editor",children:[(0,s.jsx)(l.A,{value:"vim",label:"Vim",default:!0,children:(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-sh",children:"sudo vim /etc/blackbox_exporter/blackbox.yaml\n"})})}),(0,s.jsx)(l.A,{value:"nano",label:"Nano",children:(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-sh",children:"sudo nano /etc/blackbox_exporter/blackbox.yaml\n"})})})]}),"\n",(0,s.jsxs)(r.p,{children:[(0,s.jsx)(r.strong,{children:"4.2 Paste Configuration"}),": Add the preferred server call properties."]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-text",children:"modules:\n  icmp:\n    prober: icmp\n    timeout: 10s\n    icmp:\n      preferred_ip_protocol: ipv4\n"})}),"\n",(0,s.jsx)(r.admonition,{type:"warning",children:(0,s.jsx)(r.p,{children:"Ensure the correct formatting of double-spaces the configuration to take effect correctly."})}),"\n",(0,s.jsxs)(r.p,{children:[(0,s.jsx)(r.strong,{children:"4.3 Restrict Permissions"}),": Change the ownership of the configuration file to the service user."]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-sh",children:"sudo chown -R blackbox-exporter-worker:blackbox-exporter-worker /etc/blackbox_exporter/\n"})}),"\n",(0,s.jsx)(r.h2,{id:"5-service-configuration",children:"5. Service Configuration"}),"\n",(0,s.jsx)(r.p,{children:"Once the binary and ping files are in place, we can create a service configuration for the exporter, so it automatically starts during boot and restarts during crashes. The configuration will also check for logging before it starts up and uses the previously created user."}),"\n",(0,s.jsxs)(r.p,{children:[(0,s.jsx)(r.strong,{children:"5.1 Create Service File"}),": Create a system service file using your preferred text editor."]}),"\n",(0,s.jsxs)(i.A,{groupId:"editor",children:[(0,s.jsx)(l.A,{value:"vim",label:"Vim",default:!0,children:(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-sh",children:"sudo vim /etc/systemd/system/blackbox_exporter.service\n"})})}),(0,s.jsx)(l.A,{value:"nano",label:"Nano",children:(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-sh",children:"sudo nano /etc/systemd/system/blackbox_exporter.service\n"})})})]}),"\n",(0,s.jsxs)(r.p,{children:[(0,s.jsx)(r.strong,{children:"5.2 Add Configuration"}),": Paste the following content using your preferred logging tool, then save and exit the file."]}),"\n",(0,s.jsx)(r.admonition,{type:"tip",children:(0,s.jsxs)(r.p,{children:["Further details on Journal and System Logging can be found on the ",(0,s.jsx)(r.a,{href:"/docs/theory/node-operation/utility-tools",children:(0,s.jsx)(r.strong,{children:"Utility Tools"})})," page in the the \ud83e\udde0 ",(0,s.jsx)(r.a,{href:"/docs/theory/preparations/node-specifications",children:(0,s.jsx)(r.strong,{children:"Theory"})})," section."]})}),"\n",(0,s.jsxs)(i.A,{groupId:"logging-tool",children:[(0,s.jsx)(l.A,{value:"journal",label:"Journal Logging",default:!0,children:(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-text",children:"[Unit]\nDescription=Blackbox Exporter\nDocumentation=https://github.com/prometheus/blackbox_exporter\nAfter=network.target network-online.target\n\n[Service]\nUser=blackbox-exporter-worker\nGroup=blackbox-exporter-worker\nType=simple\nExecStart=/usr/local/bin/blackbox_exporter --config.file /etc/blackbox_exporter/blackbox.yaml\nRestart=always\nRestartSec=5\nSyslogIdentifier=blackbox_exporter\nStandardOutput=journal\nStandardError=journal\nProtectSystem=full\nNoNewPrivileges=true\nPrivateTmp=true\n\n[Install]\nWantedBy=multi-user.target\n"})})}),(0,s.jsx)(l.A,{value:"system",label:"System Logging",children:(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-text",children:"[Unit]\nDescription=Blackbox Exporter\nDocumentation=https://github.com/prometheus/blackbox_exporter\nAfter=network.target network-online.target\n\n[Service]\nUser=blackbox-exporter-worker\nGroup=blackbox-exporter-worker\nType=simple\nExecStart=/usr/local/bin/blackbox_exporter --config.file /etc/blackbox_exporter/blackbox.yaml\nRestart=always\nRestartSec=5\nSyslogIdentifier=blackbox_exporter\nStandardOutput=syslog\nStandardError=syslog\nProtectSystem=full\nNoNewPrivileges=true\nPrivateTmp=true\n\n[Install]\nWantedBy=multi-user.target\n"})})})]}),"\n",(0,s.jsxs)(n,{children:[(0,s.jsx)("summary",{children:"Full Property Explanation"}),(0,s.jsxs)(r.table,{children:[(0,s.jsx)(r.thead,{children:(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.th,{children:"Property"}),(0,s.jsx)(r.th,{children:"Description"})]})}),(0,s.jsxs)(r.tbody,{children:[(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"Description"})}),(0,s.jsxs)(r.td,{children:["A human-readable description of the service shown in ",(0,s.jsx)(r.code,{children:"systemctl status"}),"."]})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"Documentation"})}),(0,s.jsx)(r.td,{children:"Link to documentation of the software that is being used for this service file."})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"After"})}),(0,s.jsxs)(r.td,{children:["- ",(0,s.jsx)(r.code,{children:"network.target"}),": Ensures networking setup enabled before service is started. ",(0,s.jsx)("br",{})," - ",(0,s.jsx)(r.code,{children:"network-online.target"}),": Waits for network to be fully online before service is started."]})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"User"})}),(0,s.jsxs)(r.td,{children:["Executes the service as the ",(0,s.jsx)(r.code,{children:"blackbox-exporter-worker"})," user."]})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"Group"})}),(0,s.jsxs)(r.td,{children:["Executes the service under the ",(0,s.jsx)(r.code,{children:"blackbox-exporter-worker"})," group."]})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"Type"})}),(0,s.jsxs)(r.td,{children:["Indicates running at a ",(0,s.jsx)(r.code,{children:"simple"})," service in the foreground without forking."]})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"ExecStart"})}),(0,s.jsxs)(r.td,{children:["Link to binary at ",(0,s.jsx)(r.code,{children:"/usr/local/bin/blackbox_exporter"}),", started with the terminal command."]})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"Restart"})}),(0,s.jsxs)(r.td,{children:["Restarts the service ",(0,s.jsx)(r.code,{children:"always"})," for a variety of reasons, errors, or timeouts."]})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"RestartSec"})}),(0,s.jsx)(r.td,{children:"Delay in seconds before restarting the service."})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"SyslogIdentifier"})}),(0,s.jsxs)(r.td,{children:["Tags logs from the service with ",(0,s.jsx)(r.code,{children:"json_exporter"})," to help distinguish them."]})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"StandardOutput"})}),(0,s.jsx)(r.td,{children:"Sends regular service logs to the journal or syslog system."})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"StandardError"})}),(0,s.jsx)(r.td,{children:"Sends error service logs to the journal or syslog system."})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"ProtectSystem"})}),(0,s.jsx)(r.td,{children:"Restricts filesystem write access outside of the service runtime."})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"NoNewPrivileges"})}),(0,s.jsx)(r.td,{children:"Prevents privilege escalation which processes can be apply for."})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"PrivateTmp"})}),(0,s.jsxs)(r.td,{children:["Creates an isolated ",(0,s.jsx)(r.code,{children:"/tmp"})," directory for the service."]})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"WantedBy"})}),(0,s.jsxs)(r.td,{children:["Binds the service to the ",(0,s.jsx)(r.code,{children:"multi-user.target"}),", so it starts during all boot processes."]})]})]})]})]}),"\n",(0,s.jsx)(r.admonition,{type:"warning",children:(0,s.jsxs)(r.p,{children:["If you renamed the user, make sure to update both ",(0,s.jsx)(r.code,{children:"User"})," and ",(0,s.jsx)(r.code,{children:"Group"})," values to prevent running the service as ",(0,s.jsx)(r.code,{children:"root"}),"."]})}),"\n",(0,s.jsx)(r.h2,{id:"6-start-the-exporter-service",children:"6. Start the Exporter Service"}),"\n",(0,s.jsx)(r.p,{children:"After setting up the service, you can enable and start the system service."}),"\n",(0,s.jsxs)(r.p,{children:[(0,s.jsx)(r.strong,{children:"6.1 Reload Daemon"}),": Reload the system daemon to include the new service."]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-sh",children:"sudo systemctl daemon-reload\n"})}),"\n",(0,s.jsxs)(r.p,{children:[(0,s.jsx)(r.strong,{children:"6.2 Start Exporter"}),": Start the Node Exporter service using the system control."]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-sh",children:"sudo systemctl start blackbox_exporter\n"})}),"\n",(0,s.jsxs)(r.p,{children:[(0,s.jsx)(r.strong,{children:"6.3 Enable Autostart"}),": Enable the service to start automatically during boot."]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-sh",children:"sudo systemctl enable blackbox_exporter\n"})}),"\n",(0,s.jsx)(r.p,{children:"The output should look similar to this:"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-text",children:"Created symlink /etc/systemd/system/multi-user.target.wants/blackbox_exporter.service \u2192 /etc/systemd/system/blackbox_exporter.service.\n"})}),"\n",(0,s.jsx)(r.h2,{id:"7-check-service-status",children:"7. Check Service Status"}),"\n",(0,s.jsx)(r.p,{children:"You can fetch the current status from the system control to check if the Blackbox Exporter service is running and configured correctly. The command will display whether it is active, enabled, or disabled and show recent log entries."}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-sh",children:"sudo systemctl status blackbox_exporter\n"})}),"\n",(0,s.jsx)(r.p,{children:"The output should look similar to this:"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-text",children:"\u25cf blackbox_exporter.service - Blackbox Exporter\n     Loaded: loaded (/etc/systemd/system/blackbox_exporter.service; enabled; vendor preset: enabled)\n     Active: active (running) since [DATE]; [TIME] ago\n       Docs: https://github.com/prometheus/blackbox_exporter\n   Main PID: 27272 (blackbox_exporter)\n      Tasks: 7 (limit: 38043)\n     Memory: 2.4M\n        CPU: 8ms\n     CGroup: /system.slice/blackbox_exporter.service\n             \u2514\u250027272 /usr/local/bin/blackbox_exporter --config.file /etc/blackbox_exporter/blackbox.>\n\n[DATE] [USER] systemd[1]: Started Blackbox Exporter.\n[DATE] [USER] blackbox_exporter[27272]: ts=2023-05-18T09:11:09.531Z caller=main.go:78 >...\n...\n"})}),"\n",(0,s.jsx)(r.h2,{id:"maintenance",children:"Maintenance"}),"\n",(0,s.jsx)(r.p,{children:"Proper maintenance ensures that all the components are working as intended and can be updated on the fly."}),"\n",(0,s.jsxs)(r.p,{children:[(0,s.jsx)(r.strong,{children:"Logging"}),": Check the latest status of the system service."]}),"\n",(0,s.jsxs)(i.A,{groupId:"logging-tool",children:[(0,s.jsx)(l.A,{value:"journal",label:"Journal Logging",default:!0,children:(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-sh",children:"sudo journalctl -f -u blackbox_exporter\n"})})}),(0,s.jsx)(l.A,{value:"system",label:"System Logging",children:(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-sh",children:"sudo tail -f /var/log/syslog | grep blackbox_exporter\n"})})})]}),"\n",(0,s.jsxs)(r.p,{children:[(0,s.jsx)(r.strong,{children:"Restarting"}),": If you made any changes or updates to configuration, reload the system daemon and start the exporter."]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-sh",children:"sudo systemctl daemon-reload\nsudo systemctl restart blackbox_exporter\n"})}),"\n",(0,s.jsxs)(r.p,{children:[(0,s.jsx)(r.strong,{children:"Stopping"}),": You can stop the exporter using the system control."]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-sh",children:"sudo systemctl stop blackbox_exporter\n"})}),"\n",(0,s.jsx)(r.admonition,{type:"tip",children:(0,s.jsxs)(r.p,{children:["Further information about system control or logging can be found on the ",(0,s.jsx)(r.a,{href:"/docs/theory/node-operation/utility-tools",children:(0,s.jsx)(r.strong,{children:"Utility Tools"})})," page in the \ud83e\udde0 ",(0,s.jsx)(r.a,{href:"/docs/theory/preparations/node-specifications",children:(0,s.jsx)(r.strong,{children:"Theory"})})," section."]})}),"\n",(0,s.jsx)(r.h2,{id:"revert-setup",children:"Revert Setup"}),"\n",(0,s.jsx)(r.p,{children:"If something went wrong, you can remove the user or delete the service and related files all together."}),"\n",(0,s.jsxs)(r.p,{children:[(0,s.jsx)(r.strong,{children:"1. Stop and Disable Service"}),": Stop the tool and remove it's service link from the system's boot."]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-sh",children:"sudo systemctl stop blackbox_exporter\nsudo systemctl disable blackbox_exporter\n"})}),"\n",(0,s.jsxs)(r.p,{children:[(0,s.jsx)(r.strong,{children:"2. Remove the Service and Config Files"}),": Delete the configurations and reload the system daemon."]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-sh",children:"sudo rm /etc/systemd/system/blackbox_exporter.service\nsudo rm -rf /etc/blackbox_exporter\nsudo systemctl daemon-reload\n"})}),"\n",(0,s.jsxs)(r.p,{children:[(0,s.jsx)(r.strong,{children:"3. Delete Binary"}),": Remove the executable Blackbox Exporter from your system."]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-sh",children:"sudo rm -rf /usr/local/bin/blackbox_exporter\n"})}),"\n",(0,s.jsxs)(r.p,{children:[(0,s.jsx)(r.strong,{children:"4. Remove User and Group"}),": Prune the user and all it's cached configurations."]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-sh",children:"sudo deluser --remove-all-files blackbox-exporter-worker\nsudo delgroup blackbox-exporter-worker\n"})})]})}function u(e={}){const{wrapper:r}={...(0,o.R)(),...e.components};return r?(0,s.jsx)(r,{...e,children:(0,s.jsx)(x,{...e})}):x(e)}},8453:(e,r,n)=>{n.d(r,{R:()=>i,x:()=>l});var t=n(6540);const s={},o=t.createContext(s);function i(e){const r=t.useContext(o);return t.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function l(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),t.createElement(o.Provider,{value:r},e.children)}},9365:(e,r,n)=>{n.d(r,{A:()=>i});n(6540);var t=n(4164);const s={tabItem:"tabItem_Ymn6"};var o=n(4848);function i({children:e,hidden:r,className:n}){return(0,o.jsx)("div",{role:"tabpanel",className:(0,t.A)(s.tabItem,n),hidden:r,children:e})}}}]);