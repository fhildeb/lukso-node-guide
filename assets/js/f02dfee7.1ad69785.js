"use strict";(globalThis.webpackChunklukso_node_guide=globalThis.webpackChunklukso_node_guide||[]).push([[3244],{1410(e,n,t){t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>c,default:()=>p,frontMatter:()=>l,metadata:()=>r,toc:()=>u});const r=JSON.parse('{"id":"guides/system-setup/bruteforce-protection","title":"3.7 Bruteforce Protection","description":"Protect your LUKSO node from SSH bruteforce attacks using Fail2Ban. Learn how to install, configure, and secure your server with automatic IP banning.","source":"@site/docs/guides/system-setup/bruteforce-protection.md","sourceDirName":"guides/system-setup","slug":"/guides/system-setup/bruteforce-protection","permalink":"/docs/guides/system-setup/bruteforce-protection","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":7,"frontMatter":{"sidebar_label":"3.7 Bruteforce Protection","sidebar_position":7,"description":"Protect your LUKSO node from SSH bruteforce attacks using Fail2Ban. Learn how to install, configure, and secure your server with automatic IP banning."},"sidebar":"guidesSidebar","previous":{"title":"3.6 Firewall Configuration","permalink":"/docs/guides/system-setup/firewall-configuration"},"next":{"title":"4.1 Address Checkup","permalink":"/docs/guides/router-setup/address-checkup"}}');var s=t(4848),i=t(8453),a=t(1470),o=t(9365);const l={sidebar_label:"3.7 Bruteforce Protection",sidebar_position:7,description:"Protect your LUKSO node from SSH bruteforce attacks using Fail2Ban. Learn how to install, configure, and secure your server with automatic IP banning."},c="3.7 Bruteforce Protection",d={},u=[{value:"1. Installation",id:"1-installation",level:2},{value:"2. Configuration",id:"2-configuration",level:2},{value:"3. Startup",id:"3-startup",level:2}];function h(e){const n={admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components},{Details:t}=n;return t||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"37-bruteforce-protection",children:"3.7 Bruteforce Protection"})}),"\n",(0,s.jsx)(n.p,{children:"Bruteforce protection is a critical aspect of securing blockchain nodes and servers. As these systems handle sensitive data and valuable assets, they are prime targets for attackers attempting systematic login attempts. To mitigate such threats, we can use a security tool that monitors failed logins and automatically updates firewall rules."}),"\n",(0,s.jsx)(n.admonition,{type:"tip",children:(0,s.jsxs)(n.p,{children:["We'll install the famous security tool named ",(0,s.jsx)(n.code,{children:"Fail2Ban"}),", that blocks offending IP addresses for a specified duration."]})}),"\n",(0,s.jsx)(n.h2,{id:"1-installation",children:"1. Installation"}),"\n",(0,s.jsx)(n.p,{children:"First, we need to get the service installed using APT:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"sudo apt install fail2ban\n"})}),"\n",(0,s.jsx)(n.p,{children:"After the installation has been successful, we can continue its configuration."}),"\n",(0,s.jsx)(n.h2,{id:"2-configuration",children:"2. Configuration"}),"\n",(0,s.jsx)(n.p,{children:"This sequence will add properties for the SSH daemon process. Protecting the SSH port on any blockchain node or server is recommended, as it is the only way to access our node."}),"\n",(0,s.jsxs)(n.admonition,{type:"info",children:[(0,s.jsx)(n.p,{children:"The brutefore protection comes with separate configuration files:"}),(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"/etc/fail2ban/jail.conf"})," : The updateble default configuration"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"/etc/fail2ban/jail.local"}),": An optional, static rules for each port and service"]}),"\n"]}),(0,s.jsx)(n.p,{children:"Its recommended to create the additional file, as those settings persist through any software updates."})]}),"\n",(0,s.jsx)(n.p,{children:"Open the configuration file in your preferred text editor:"}),"\n",(0,s.jsxs)(a.A,{children:[(0,s.jsx)(o.A,{value:"vim",label:"Vim",default:!0,children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"sudo vim /etc/fail2ban/jail.local\n"})})}),(0,s.jsx)(o.A,{value:"nano",label:"Nano",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"sudo nano /etc/fail2ban/jail.local\n"})})})]}),"\n",(0,s.jsx)(n.p,{children:"Then, add the following configuration snippet to protect the SSH daemon:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-text",children:"[sshd]\nenabled=true\nport=<desired-port-number>\nfilter=sshd\nlogpath=/var/log/auth.log\nmaxretry=3\nfindtime=300\nbantime=28800\nbackend=auto\nignoreip=127.0.0.1/8\n"})}),"\n",(0,s.jsx)(n.admonition,{type:"warning",children:(0,s.jsx)(n.p,{children:"Ensure there are no extra spaces between property names and their values to avoid syntax errors."})}),"\n",(0,s.jsxs)(n.admonition,{type:"note",children:[(0,s.jsxs)(n.p,{children:["Replace ",(0,s.jsx)(n.code,{children:"<desired-port-number>"})," with the SSH port you configured for your node."]}),(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"maxretry"})," = 3: Limits failed login attempts."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"findtime"})," = 300: Specifies a time window of 5 minutes before failed attempts are reset."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"bantime"})," = 28800: Bans an IP for 8 hours if the limit is exceeded."]}),"\n"]})]}),"\n",(0,s.jsxs)(t,{children:[(0,s.jsx)("summary",{children:"Full Property Explanation"}),(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:(0,s.jsx)(n.strong,{children:"Option"})}),(0,s.jsx)(n.th,{children:(0,s.jsx)(n.strong,{children:"Description"})}),(0,s.jsx)(n.th,{children:(0,s.jsx)(n.strong,{children:"Value"})})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"[ ]"})}),(0,s.jsx)(n.td,{children:"Tag for the service declaration."}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"sshd"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"enabled"})}),(0,s.jsx)(n.td,{children:"Whether this rule is active when the SSH service is running."}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"true"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"port"})}),(0,s.jsx)(n.td,{children:"Port number on which the SSH daemon listens."}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"22"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"filter"})}),(0,s.jsx)(n.td,{children:"Name of the filter definition used to parse log entries and detect failed attempts."}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"sshd"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"logpath"})}),(0,s.jsx)(n.td,{children:"Full path to the log file to monitor for failed login attempts."}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"/var/log/auth.log"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"maxretry"})}),(0,s.jsxs)(n.td,{children:["Number of failed login attempts within the ",(0,s.jsx)(n.code,{children:"findtime"})," window before banning the IP."]}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"3"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"findtime"})}),(0,s.jsxs)(n.td,{children:["Time window in seconds during which ",(0,s.jsx)(n.code,{children:"maxretry"})," failures are counted."]}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"300"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"bantime"})}),(0,s.jsxs)(n.td,{children:["Duration in seconds for which an IP is banned after exceeding ",(0,s.jsx)(n.code,{children:"maxretry"})]}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"28800"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"backend"})}),(0,s.jsx)(n.td,{children:"Default backend type used to monitor the log file."}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"auto"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"ignoreip"})}),(0,s.jsx)(n.td,{children:"Space\u2011separated list of IP addresses exempted from banning."}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"127.0.0.1/8"})})]})]})]})]}),"\n",(0,s.jsx)(n.admonition,{type:"tip",children:(0,s.jsx)(n.p,{children:"Instead of just including the localhost range to the ignored IP addresses in order to avoid self\u2011lockout, you can also append any trusted IP or VPN range if you are using a specific tunnel network."})}),"\n",(0,s.jsx)(n.h2,{id:"3-startup",children:"3. Startup"}),"\n",(0,s.jsx)(n.p,{children:"After configuring the brutefore protection for our SSH Port, we need to refresh our services to include newly set up rules."}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"1. Reload the System Manager Configuration"}),": ",(0,s.jsx)(n.em,{children:"Registers any new or updated service files."})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"sudo systemctl daemon-reload\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"2. Start the Bruteforce Protection Tool"}),": ",(0,s.jsx)(n.em,{children:"Launches the service file."})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"sudo systemctl start fail2ban\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"3. Enable Automatic Startup"}),": ",(0,s.jsx)(n.em,{children:"Creates a symbolic link to include the service in the boot process."})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"sudo systemctl enable fail2ban\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"4. Verify Service Status"}),": ",(0,s.jsx)(n.em,{children:"Checks the service's unit files, state, and log file."})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"sudo systemctl status fail2ban\n"})}),"\n",(0,s.jsx)(n.p,{children:"The output should indicate that the service is active and running:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-text",children:"\u25cf fail2ban.service - Fail2Ban Service\n     Loaded: loaded (/lib/systemd/system/fail2ban.service; enabled; vendor preset: enabled)\n     Active: active (running) since [DATE]; [TIME] ago\n       Docs: man:fail2ban(1)\n   Main PID: 5875 (fail2ban-server)\n      Tasks: 5 (limit: 38043)\n     Memory: [USED_MEMORY]\n        CPU: [EXECUTION_TIME]\n     CGroup: /system.slice/fail2ban.service\n             \u2514\u25005875 /usr/bin/python3 /usr/bin/fail2ban-server -xf start\n\n[DATE] [USER] systemd[PID]: Started Fail2Ban Service.\n[DATE] [USER] fail2ban-server[PID]: Server ready\n"})})]})}function p(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}},9365(e,n,t){t.d(n,{A:()=>a});t(6540);var r=t(4164);const s="tabItem_Ymn6";var i=t(4848);function a({children:e,hidden:n,className:t}){return(0,i.jsx)("div",{role:"tabpanel",className:(0,r.A)(s,t),hidden:n,children:e})}},1470(e,n,t){t.d(n,{A:()=>k});var r=t(6540),s=t(4164),i=t(7559),a=t(3104),o=t(6347),l=t(205),c=t(7485),d=t(1682),u=t(679);function h(e){return r.Children.toArray(e).filter(e=>"\n"!==e).map(e=>{if(!e||(0,r.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})?.filter(Boolean)??[]}function p(e){const{values:n,children:t}=e;return(0,r.useMemo)(()=>{const e=n??function(e){return h(e).map(({props:{value:e,label:n,attributes:t,default:r}})=>({value:e,label:n,attributes:t,default:r}))}(t);return function(e){const n=(0,d.XI)(e,(e,n)=>e.value===n.value);if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map(e=>e.value).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e},[n,t])}function f({value:e,tabValues:n}){return n.some(n=>n.value===e)}function x({queryString:e=!1,groupId:n}){const t=(0,o.W6)(),s=function({queryString:e=!1,groupId:n}){if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:e,groupId:n});return[(0,c.aZ)(s),(0,r.useCallback)(e=>{if(!s)return;const n=new URLSearchParams(t.location.search);n.set(s,e),t.replace({...t.location,search:n.toString()})},[s,t])]}function j(e){const{defaultValue:n,queryString:t=!1,groupId:s}=e,i=p(e),[a,o]=(0,r.useState)(()=>function({defaultValue:e,tabValues:n}){if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!f({value:e,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${n.map(e=>e.value).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}const t=n.find(e=>e.default)??n[0];if(!t)throw new Error("Unexpected error: 0 tabValues");return t.value}({defaultValue:n,tabValues:i})),[c,d]=x({queryString:t,groupId:s}),[h,j]=function({groupId:e}){const n=function(e){return e?`docusaurus.tab.${e}`:null}(e),[t,s]=(0,u.Dv)(n);return[t,(0,r.useCallback)(e=>{n&&s.set(e)},[n,s])]}({groupId:s}),m=(()=>{const e=c??h;return f({value:e,tabValues:i})?e:null})();(0,l.A)(()=>{m&&o(m)},[m]);return{selectedValue:a,selectValue:(0,r.useCallback)(e=>{if(!f({value:e,tabValues:i}))throw new Error(`Can't select invalid tab value=${e}`);o(e),d(e),j(e)},[d,j,i]),tabValues:i}}var m=t(2303);const g="tabList__CuJ",b="tabItem_LNqP";var v=t(4848);function y({className:e,block:n,selectedValue:t,selectValue:r,tabValues:i}){const o=[],{blockElementScrollPositionUntilNextRender:l}=(0,a.a_)(),c=e=>{const n=e.currentTarget,s=o.indexOf(n),a=i[s].value;a!==t&&(l(n),r(a))},d=e=>{let n=null;switch(e.key){case"Enter":c(e);break;case"ArrowRight":{const t=o.indexOf(e.currentTarget)+1;n=o[t]??o[0];break}case"ArrowLeft":{const t=o.indexOf(e.currentTarget)-1;n=o[t]??o[o.length-1];break}}n?.focus()};return(0,v.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,s.A)("tabs",{"tabs--block":n},e),children:i.map(({value:e,label:n,attributes:r})=>(0,v.jsx)("li",{role:"tab",tabIndex:t===e?0:-1,"aria-selected":t===e,ref:e=>{o.push(e)},onKeyDown:d,onClick:c,...r,className:(0,s.A)("tabs__item",b,r?.className,{"tabs__item--active":t===e}),children:n??e},e))})}function w({lazy:e,children:n,selectedValue:t}){const i=(Array.isArray(n)?n:[n]).filter(Boolean);if(e){const e=i.find(e=>e.props.value===t);return e?(0,r.cloneElement)(e,{className:(0,s.A)("margin-top--md",e.props.className)}):null}return(0,v.jsx)("div",{className:"margin-top--md",children:i.map((e,n)=>(0,r.cloneElement)(e,{key:n,hidden:e.props.value!==t}))})}function S(e){const n=j(e);return(0,v.jsxs)("div",{className:(0,s.A)(i.G.tabs.container,"tabs-container",g),children:[(0,v.jsx)(y,{...n,...e}),(0,v.jsx)(w,{...n,...e})]})}function k(e){const n=(0,m.A)();return(0,v.jsx)(S,{...e,children:h(e.children)},String(n))}},8453(e,n,t){t.d(n,{R:()=>a,x:()=>o});var r=t(6540);const s={},i=r.createContext(s);function a(e){const n=r.useContext(i);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),r.createElement(i.Provider,{value:n},e.children)}}}]);